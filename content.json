[{"title":"mongodb总结","date":"2018-08-12T12:41:55.000Z","path":"2018/08/12/mongodb总结/","text":"1.简介mongodb是nosql中的一款产品，属于文档型数据库，存储的是文档（Bson,json的二进制化），内部引擎由javascript实现，所有和node.js搭配使用有天然的优势。 数据在存储时是以bson形式进行存储的，查询时数据转换为js对象，并可以通过js语法进行操作。注意事项: MongoDB不支持事务和夺标连接将查询 MongoDB中键值对是有序的,相同的键值对,不同顺序,属于不同的文档 new Date(); 返回日期对象，属于日期类型，Date()函数返回日期字符串，在Shell中操作日期要使用日期类型， 日期类型是包含时区的 2.bin目录文件作用 bsondump: 导出bson结构（可视化转化）mongodump: 整体导出bson数据mongorestore: 导入bsonmongo: 客户端mongod: 服务端mongos: 查询路由，用于分片mongoexport: 导出json,csv,tsv格式mongoimport: 导入bson: 导出bson结构bsondump: 导出bson结构bsondump: 导出bson结构 3.mongod参数说明 –bind_ip 绑定固定ip–bind_ip_all 绑定所有ip–dbpath 数据库存储目录–logpath log file to send write to instead of stdout - has to be a file, not directory–port 指定端口，default 27017–fork fork server process(后台demon运行)–smallfiles 小空间运行–directoryperdb each database will be stored in a separate directory(创建独立子目录)–logappend 追加日志–pidfilepath full path to pidfile,默认不创建–keyFile 集群标识（授权使用）–journal 启用日志–maxConns 最大连接并发数–notablescan 不允许表扫描/bin/mongo dbaddress –port 17720 –eval “db.shutdownServer()”: 关闭服务 4.mongo参数说明 –port/host 连接端口/主机–eval 解析javascript–username 用户名–password 密码–quit be less chatty–shell 运行完文件进入shell 5.相关命令5.1 DDL:123456789101112show dbs/databases: 显示数据库db.dropDatabase(): 删除所在数据库use dbname: 选库/隐式创建数据库show tables/collections: 显示数据表db.getName(): 显示所在数据库名称db.version(): mongo版本db.hostInfo(): 获取mongo所在服务器主机信息db.createCollection(name, &#123;size, capped, max&#125;): 创建表db.collectionName.drop(): 删除表db.listCommands(): 列出数据库命令print(\"hello\"): 打印语句exit 退出mongoClient 5.2 DQL:123456db.collectionName.count(): 统计条数db.collectionName.find([query], [fields]).pretty(): 查看并美化所有数据db.collectionName.find(&#123;'a':'b'&#125;): 条件查询db.collectionName.find(&#123;field:&#123;$lt:ISODate('2018-08-05')&#125;&#125;)[.count()]: 小于2018-08-05的数据[数量]例: db.collectionName.find(&#123;\"age\": &#123;$lt:20&#125;&#125;) //查询条件,相当于select * from collectionName where age &lt; 20db.collectionName.findOne([query], [fields], [options]): 查询一条,相当于select * from users limit 1 5.3 DML:1234db.collectionName.insert([&#123;'a': 'b', 'c': 'd'&#125;,&#123;&#125;]): 插入数据db.collectionName.insertOne(obj, &lt;optional&gt;): 插入单条db.collectionName.remove(&#123;'a':'b'&#125;): 条件删除db.collectionName.save(obj): 集合中不包含id或者id在表中不存在则插入,存在则更新(整体替换) 5.4 Help:123456789db.help(): help on db methodsdb.collectionName.help(): help on collection methodssh.help(): sharding helpersrs.help(): replica set helpershelp admin: administrative helphelp connect: connecting to a db helphelp keys: key shortcutshelp misc: misc things to knowhelp mr: mapreduce","tags":[]}]